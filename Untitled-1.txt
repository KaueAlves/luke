Public KEY_P As String
Public NUM_PRO As String
Public DT_PAG As String
Public TP_DOC As String
Public NUM_DOC_CNPJ As String
Public VL_PAG As Currency
Public COMP_PAG As String
Public NOME_PRO As String
Public NUM_PAR As Inter
Public FOR_PAG As String
Public FOR_PAG_DT As String
Public ISENCAO As String
Public MOTIVO_ISENCAO As String
Public HISTORICO As String
'Public PARCELAS As ArrayList

'Primeira linha
Pagamento.KEY_P =  range("a" & linha_planilha)
Pagamento.NUM_PRO =  range("b" & linha_planilha)
Pagamento.DT_PAG =  range("c" & linha_planilha)
Pagamento.TP_DOC =  range("d" & linha_planilha)
Pagamento.NUM_DOC_CNPJ = range("e" & linha_planilha)
Pagamento.VL_PAG =  range("f" & linha_planilha)
Pagamento.COMP_PAG =  range("g" & linha_planilha)
'Segunda linha
Pagamento.NOME_PRO =  range("b" & linha_planilha + 1)
Pagamento.NUM_PAR =  range("c" & linha_planilha + 1)
Pagamento.FOR_PAG =  range("d" & linha_planilha + 1)
Pagamento.FOR_PAG_DT =  range("e" & linha_planilha + 1)
'Terceira linha
Pagamento.ISENCAO =  range("b" & linha_planilha +2)
Pagamento.MOTIVO_ISENCAO =  range("c" & linha_planilha+2) 
Pagamento.HISTORICO = range("d" & linha_planilha+2)



Dim linha_final As Interger
Set linha_final = 16 'Mudar
Dim linha_planilha as Interger
Dim linha_parcela as Interger
Dim parcelas As Interger


for linha_planilha = 1 to linha_final 

    if(linha_planilha = 1 AND range("a" & linha_planilha) <> null ) THEN EXIT SUB

    if(linha_planilha = 1 OR Pagamento.KEY_P <> range("a" & linha_planilha)) THEN
        'Primeira linha
        Pagamento.KEY_P =  range("a" & linha_planilha)
        Pagamento.NUM_PRO =  range("b" & linha_planilha)
        Pagamento.DT_PAG =  range("c" & linha_planilha)
        Pagamento.TP_DOC =  range("d" & linha_planilha)
        Pagamento.NUM_DOC_CNPJ = range("e" & linha_planilha)
        Pagamento.VL_PAG =  range("f" & linha_planilha)
        Pagamento.COMP_PAG =  range("g" & linha_planilha)
        'Segunda linha
        Pagamento.NOME_PRO =  range("b" & linha_planilha + 1)
        Pagamento.NUM_PAR =  range("c" & linha_planilha + 1)
        Pagamento.FOR_PAG =  range("d" & linha_planilha + 1)
        Pagamento.FOR_PAG_DT =  range("e" & linha_planilha + 1)
        'Terceira linha
        Pagamento.ISENCAO =  range("b" & linha_planilha +2)
        Pagamento.MOTIVO_ISENCAO =  range("c" & linha_planilha+2) 
        Pagamento.HISTORICO = range("d" & linha_planilha+2)
    END IF 

    linha_parcela = linha_planilha + 3

    do while Pagamento.KEY_P = range("a" & linha_parcela) do
        
        linha_parcela = linha_parcela + 1
    loop

    linha_planilha = linha_planilha + Pagamento.NUM_PAR + 2
    


next


 